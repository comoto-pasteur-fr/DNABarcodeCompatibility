<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="pandoc">

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Céline Trébeau &amp; Raphaël Etournay">

<meta name="date" content="2018-06-12">

<title>Introduction to DNABarcodeCompatibility</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css">

<script type="text/javascript" src="index_fichiers/MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body><div id="MathJax_Message" style="display: none;"></div>




<h1 class="title toc-ignore">Introduction to DNABarcodeCompatibility</h1>
<h4 class="author"><em>Céline Trébeau &amp; Raphaël Etournay</em></h4>
<h4 class="date"><em>2018-06-12</em></h4>



<p>This document introduces you to DNABarcodeCompatibility’s basic set of tools.</p>
<p>The DNABarcodeCompatibility package provides six functions and two 
barcode datasets for running examples. The functions allow one to load 
DNA barcodes, to generate, filter and optimize sets of compatible 
barcode combinations for multiplex sequecing experiments. In particular,
 the package provides an optimizer function to further favor the 
selection of compatible barcode combinations with <strong>least redundancy of DNA barcodes</strong> and allows one to keep barcodes that are <strong>robust against substitution and insertion/deletion errors</strong> thereby facilitating the demultiplexing step.</p>
<p>This package contains:</p>
<ul>
<li>one workflow called <code>experiment_design()</code> to perfom all steps in one go</li>
<li>two datasets called <code>IlluminaIndexesRaw</code> and <code>IlluminaIndexes</code> for running examples</li>
<li>a series of API to build your own workflow</li>
</ul>
<p>This package deals with the three existing sequencing-by-synthesis chemistries from Illumina:</p>
<ul>
<li>Four-Channel SBS Chemistry: MiSeq, HiSeq systems</li>
<li>Two-Channel SBS Chemistry: MiniSeq, NextSeq, NovaSeq systems</li>
<li>One-Channel SBS Chemistry: iSeq system</li>
</ul>
<div id="load-the-package" class="section level2">
<h2>Load the package</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"DNABarcodeCompatibility"</span>)</code></pre></div>
</div>
<div id="define-a-helper-function-to-save-the-raw-dataset-as-a-temporary-text-file" class="section level2">
<h2>Define a helper function to save the raw dataset as a temporary text file</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This function is created for the purpose of the documentation </span>
export_dataset_to_file =<span class="st"> </span><span class="cf">function</span>(<span class="dt">dataset =</span> DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw) {
  <span class="cf">if</span> (<span class="kw">class</span>(dataset)<span class="op">==</span><span class="st">"data.frame"</span>) {
    <span class="kw">write.table</span>(dataset,
                textfile &lt;-<span class="st"> </span><span class="kw">tempfile</span>(), <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">FALSE</span>, <span class="dt">quote=</span><span class="ot">FALSE</span>)
    <span class="kw">return</span>(textfile)
  } <span class="cf">else</span> <span class="kw">print</span>(<span class="st">"The input dataset isn't a data.frame: NOT exported into file"</span>)
}</code></pre></div>
</div>
<div id="design-an-experiment" class="section level2">
<h2>Design an experiment</h2>
<p>The function <code>experiment_design()</code> uses a Shannon-entropy 
maximization approach to identify a set of compatible barcode 
combinations with least redundancy between DNA barcodes, in the contexts
 of single and dual barcoding. It performs either an exhaustive or a 
random search of compatible DNA-barcode combinations depending on the 
size of the DNA-barcode population and of the number of samples to be 
multiplexed.</p>
<div id="examples-for-single-indexing" class="section level3">
<h3>Examples for single indexing</h3>
<ul>
<li>12 libraries sequenced in multiplex of 3 on a HiSeq (4 channels) platform</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">txtfile &lt;-<span class="st"> </span><span class="kw">export_dataset_to_file</span>(<span class="dt">dataset =</span> DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw)
<span class="kw">experiment_design</span>(<span class="dt">file1=</span>txtfile, <span class="dt">sample_number=</span><span class="dv">12</span>, <span class="dt">mplex_level=</span><span class="dv">3</span>, <span class="dt">chemistry=</span><span class="dv">4</span>)
<span class="co">#&gt; [1] "Theoretical max entropy: 2.485"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 2.485"</span>
<span class="co">#&gt;    sample Lane    Id sequence</span>
<span class="co">#&gt; 1       1    1 RPI02   CGATGT</span>
<span class="co">#&gt; 2       2    1 RPI12   CTTGTA</span>
<span class="co">#&gt; 3       3    1 RPI44   TATAAT</span>
<span class="co">#&gt; 4       4    2 RPI21   GTTTCG</span>
<span class="co">#&gt; 5       5    2 RPI37   CGGAAT</span>
<span class="co">#&gt; 6       6    2 RPI46   TCCCGA</span>
<span class="co">#&gt; 7       7    3 RPI10   TAGCTT</span>
<span class="co">#&gt; 8       8    3 RPI13   AGTCAA</span>
<span class="co">#&gt; 9       9    3 RPI41   GACGAC</span>
<span class="co">#&gt; 10     10    4 RPI18   GTCCGC</span>
<span class="co">#&gt; 11     11    4 RPI23   GAGTGG</span>
<span class="co">#&gt; 12     12    4 RPI32   CACTCA</span></code></pre></div>
<ul>
<li>12 libraries sequenced in multiplex of 3 on a NextSeq (2 channels) platform</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">txtfile &lt;-<span class="st"> </span><span class="kw">export_dataset_to_file</span>(<span class="dt">dataset =</span> DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw)
<span class="kw">experiment_design</span>(<span class="dt">file1=</span>txtfile, <span class="dt">sample_number=</span><span class="dv">12</span>, <span class="dt">mplex_level=</span><span class="dv">3</span>, <span class="dt">chemistry=</span><span class="dv">2</span>)
<span class="co">#&gt; [1] "Theoretical max entropy: 2.485"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 2.485"</span>
<span class="co">#&gt;    sample Lane    Id sequence</span>
<span class="co">#&gt; 1       1    1 RPI02   CGATGT</span>
<span class="co">#&gt; 2       2    1 RPI40   CTCAGA</span>
<span class="co">#&gt; 3       3    1 RPI47   TCGAAG</span>
<span class="co">#&gt; 4       4    2 RPI37   CGGAAT</span>
<span class="co">#&gt; 5       5    2 RPI44   TATAAT</span>
<span class="co">#&gt; 6       6    2 RPI46   TCCCGA</span>
<span class="co">#&gt; 7       7    3 RPI33   CAGGCG</span>
<span class="co">#&gt; 8       8    3 RPI35   CATTTT</span>
<span class="co">#&gt; 9       9    3 RPI43   TACAGC</span>
<span class="co">#&gt; 10     10    4 RPI03   TTAGGC</span>
<span class="co">#&gt; 11     11    4 RPI06   GCCAAT</span>
<span class="co">#&gt; 12     12    4 RPI07   CAGATC</span></code></pre></div>
<ul>
<li>12 libraries sequenced in multiplex of 3 on a iSeq (1 channels) platform</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">txtfile &lt;-<span class="st"> </span><span class="kw">export_dataset_to_file</span>(<span class="dt">dataset =</span> DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw)
<span class="kw">experiment_design</span>(<span class="dt">file1=</span>txtfile, <span class="dt">sample_number=</span><span class="dv">12</span>, <span class="dt">mplex_level=</span><span class="dv">3</span>, <span class="dt">chemistry=</span><span class="dv">1</span>)
<span class="co">#&gt; [1] "Theoretical max entropy: 2.485"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 2.485"</span>
<span class="co">#&gt;    sample Lane    Id sequence</span>
<span class="co">#&gt; 1       1    1 RPI01   ATCACG</span>
<span class="co">#&gt; 2       2    1 RPI11   GGCTAC</span>
<span class="co">#&gt; 3       3    1 RPI36   CCAACA</span>
<span class="co">#&gt; 4       4    2 RPI13   AGTCAA</span>
<span class="co">#&gt; 5       5    2 RPI38   CTAGCT</span>
<span class="co">#&gt; 6       6    2 RPI40   CTCAGA</span>
<span class="co">#&gt; 7       7    3 RPI02   CGATGT</span>
<span class="co">#&gt; 8       8    3 RPI41   GACGAC</span>
<span class="co">#&gt; 9       9    3 RPI48   TCGGCA</span>
<span class="co">#&gt; 10     10    4 RPI14   AGTTCC</span>
<span class="co">#&gt; 11     11    4 RPI15   ATGTCA</span>
<span class="co">#&gt; 12     12    4 RPI28   CAAAAG</span></code></pre></div>
<ul>
<li>12 libraries sequenced in multiplex of 3 on a HiSeq platform using barcodes robust against 1 substitution error</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">txtfile &lt;-<span class="st"> </span><span class="kw">export_dataset_to_file</span>(<span class="dt">dataset =</span> DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw)
<span class="kw">experiment_design</span>(<span class="dt">file1=</span>txtfile, <span class="dt">sample_number=</span><span class="dv">12</span>, <span class="dt">mplex_level=</span><span class="dv">3</span>, <span class="dt">chemistry=</span><span class="dv">4</span>, <span class="dt">metric =</span> <span class="st">"hamming"</span>, <span class="dt">d =</span> <span class="dv">3</span>)
<span class="co">#&gt; [1] "Theoretical max entropy: 2.485"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 2.485"</span>
<span class="co">#&gt;    sample Lane    Id sequence</span>
<span class="co">#&gt; 1       1    1 RPI03   TTAGGC</span>
<span class="co">#&gt; 2       2    1 RPI16   CCGTCC</span>
<span class="co">#&gt; 3       3    1 RPI22   CGTACG</span>
<span class="co">#&gt; 4       4    2 RPI02   CGATGT</span>
<span class="co">#&gt; 5       5    2 RPI08   ACTTGA</span>
<span class="co">#&gt; 6       6    2 RPI47   TCGAAG</span>
<span class="co">#&gt; 7       7    3 RPI09   GATCAG</span>
<span class="co">#&gt; 8       8    3 RPI17   GTAGAG</span>
<span class="co">#&gt; 9       9    3 RPI34   CATGGC</span>
<span class="co">#&gt; 10     10    4 RPI04   TGACCA</span>
<span class="co">#&gt; 11     11    4 RPI33   CAGGCG</span>
<span class="co">#&gt; 12     12    4 RPI40   CTCAGA</span></code></pre></div>
</div>
<div id="examples-for-dual-indexing" class="section level3">
<h3>Examples for dual indexing</h3>
<ul>
<li>12 libraries sequenced in multiplex of 3 on a HiSeq platform</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select the first half of barcodes from the dataset</span>
txtfile1 &lt;-<span class="st"> </span><span class="kw">export_dataset_to_file</span>(DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw[<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>,])

<span class="co"># Select the second half of barcodes from the dataset</span>
txtfile2 &lt;-<span class="st"> </span><span class="kw">export_dataset_to_file</span>(DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw[<span class="dv">25</span><span class="op">:</span><span class="dv">48</span>,])

<span class="co"># Get compatibles combinations of least redundant barcodes</span>
<span class="kw">experiment_design</span>(<span class="dt">file1=</span>txtfile1, <span class="dt">sample_number=</span><span class="dv">12</span>, <span class="dt">mplex_level=</span><span class="dv">3</span>, <span class="dt">chemistry=</span><span class="dv">4</span>, <span class="dt">file2=</span>txtfile2)
<span class="co">#&gt; [1] "Theoretical max entropy: 2.485"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 2.485"</span>
<span class="co">#&gt; [1] "Theoretical max entropy: 2.485"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 2.485"</span>
<span class="co">#&gt;    sample Lane   Id1 sequence1   Id2 sequence2</span>
<span class="co">#&gt; 1       1    1 RPI09    GATCAG RPI33    CAGGCG</span>
<span class="co">#&gt; 2       2    1 RPI11    GGCTAC RPI39    CTATAC</span>
<span class="co">#&gt; 3       3    1 RPI12    CTTGTA RPI46    TCCCGA</span>
<span class="co">#&gt; 4       4    2 RPI03    TTAGGC RPI27    ATTCCT</span>
<span class="co">#&gt; 5       5    2 RPI06    GCCAAT RPI29    CAACTA</span>
<span class="co">#&gt; 6       6    2 RPI15    ATGTCA RPI48    TCGGCA</span>
<span class="co">#&gt; 7       7    3 RPI07    CAGATC RPI25    ACTGAT</span>
<span class="co">#&gt; 8       8    3 RPI17    GTAGAG RPI38    CTAGCT</span>
<span class="co">#&gt; 9       9    3 RPI20    GTGGCC RPI43    TACAGC</span>
<span class="co">#&gt; 10     10    4 RPI01    ATCACG RPI36    CCAACA</span>
<span class="co">#&gt; 11     11    4 RPI13    AGTCAA RPI37    CGGAAT</span>
<span class="co">#&gt; 12     12    4 RPI23    GAGTGG RPI45    TCATTC</span></code></pre></div>
<ul>
<li>12 libraries sequenced in multiplex of 3 on a HiSeq platform using barcodes robust against 1 substitution error</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select the first half of barcodes from the dataset</span>
txtfile1 &lt;-<span class="st"> </span><span class="kw">export_dataset_to_file</span>(DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw[<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>,])

<span class="co"># Select the second half of barcodes from the dataset</span>
txtfile2 &lt;-<span class="st"> </span><span class="kw">export_dataset_to_file</span>(DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw[<span class="dv">25</span><span class="op">:</span><span class="dv">48</span>,])

<span class="co"># Get compatibles combinations of least redundant barcodes</span>
<span class="kw">experiment_design</span>(<span class="dt">file1=</span>txtfile1, <span class="dt">sample_number=</span><span class="dv">12</span>, <span class="dt">mplex_level=</span><span class="dv">3</span>, <span class="dt">chemistry=</span><span class="dv">4</span>, <span class="dt">file2=</span>txtfile2, <span class="dt">metric=</span><span class="st">"hamming"</span>, <span class="dt">d=</span><span class="dv">3</span>)
<span class="co">#&gt; [1] "Theoretical max entropy: 2.485"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 2.485"</span>
<span class="co">#&gt; [1] "Theoretical max entropy: 2.485"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 2.485"</span>
<span class="co">#&gt;    sample Lane   Id1 sequence1   Id2 sequence2</span>
<span class="co">#&gt; 1       1    1 RPI02    CGATGT RPI35    CATTTT</span>
<span class="co">#&gt; 2       2    1 RPI07    CAGATC RPI39    CTATAC</span>
<span class="co">#&gt; 3       3    1 RPI20    GTGGCC RPI47    TCGAAG</span>
<span class="co">#&gt; 4       4    2 RPI13    AGTCAA RPI26    ATGAGC</span>
<span class="co">#&gt; 5       5    2 RPI18    GTCCGC RPI28    CAAAAG</span>
<span class="co">#&gt; 6       6    2 RPI23    GAGTGG RPI41    GACGAC</span>
<span class="co">#&gt; 7       7    3 RPI03    TTAGGC RPI36    CCAACA</span>
<span class="co">#&gt; 8       8    3 RPI16    CCGTCC RPI37    CGGAAT</span>
<span class="co">#&gt; 9       9    3 RPI22    CGTACG RPI45    TCATTC</span>
<span class="co">#&gt; 10     10    4 RPI10    TAGCTT RPI27    ATTCCT</span>
<span class="co">#&gt; 11     11    4 RPI11    GGCTAC RPI29    CAACTA</span>
<span class="co">#&gt; 12     12    4 RPI15    ATGTCA RPI42    TAATCG</span></code></pre></div>
</div>
</div>
<div id="buid-your-own-workflow" class="section level2">
<h2>Buid your own workflow</h2>
<p>This section guides you through the detailed API of the package with 
the aim to build your own workflow. This will give you more flexibility 
than the <code>experiment_design()</code> function.</p>
<div id="load-and-check-a-dataset-of-barcodes" class="section level3">
<h3>Load and check a dataset of barcodes</h3>
<p>The <code>file_loading_and_checking()</code> function loads the file 
containing the DNA barcodes and analyzes its content. In particular, it 
checks barcodes for unicity (identifier and sequence), DNA content, and 
equal size. It also calculates the GC content and detects the presence 
of homopolymers of length &gt;= 3.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">file_loading_and_checking</span>(<span class="dt">file =</span> <span class="kw">export_dataset_to_file</span>(<span class="dt">dataset =</span> DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexesRaw))
<span class="co">#&gt;       Id sequence GC_content homopolymer</span>
<span class="co">#&gt; 1  RPI01   ATCACG      50.00       FALSE</span>
<span class="co">#&gt; 2  RPI02   CGATGT      50.00       FALSE</span>
<span class="co">#&gt; 3  RPI03   TTAGGC      50.00       FALSE</span>
<span class="co">#&gt; 4  RPI04   TGACCA      50.00       FALSE</span>
<span class="co">#&gt; 5  RPI05   ACAGTG      50.00       FALSE</span>
<span class="co">#&gt; 6  RPI06   GCCAAT      50.00       FALSE</span>
<span class="co">#&gt; 7  RPI07   CAGATC      50.00       FALSE</span>
<span class="co">#&gt; 8  RPI08   ACTTGA      33.33       FALSE</span>
<span class="co">#&gt; 9  RPI09   GATCAG      50.00       FALSE</span>
<span class="co">#&gt; 10 RPI10   TAGCTT      33.33       FALSE</span>
<span class="co">#&gt; 11 RPI11   GGCTAC      66.67       FALSE</span>
<span class="co">#&gt; 12 RPI12   CTTGTA      33.33       FALSE</span>
<span class="co">#&gt; 13 RPI13   AGTCAA      33.33       FALSE</span>
<span class="co">#&gt; 14 RPI14   AGTTCC      50.00       FALSE</span>
<span class="co">#&gt; 15 RPI15   ATGTCA      33.33       FALSE</span>
<span class="co">#&gt; 16 RPI16   CCGTCC      83.33       FALSE</span>
<span class="co">#&gt; 17 RPI17   GTAGAG      50.00       FALSE</span>
<span class="co">#&gt; 18 RPI18   GTCCGC      83.33       FALSE</span>
<span class="co">#&gt; 19 RPI19   GTGAAA      33.33        TRUE</span>
<span class="co">#&gt; 20 RPI20   GTGGCC      83.33       FALSE</span>
<span class="co">#&gt; 21 RPI21   GTTTCG      50.00        TRUE</span>
<span class="co">#&gt; 22 RPI22   CGTACG      66.67       FALSE</span>
<span class="co">#&gt; 23 RPI23   GAGTGG      66.67       FALSE</span>
<span class="co">#&gt; 24 RPI24   GGTAGC      66.67       FALSE</span>
<span class="co">#&gt; 25 RPI25   ACTGAT      33.33       FALSE</span>
<span class="co">#&gt; 26 RPI26   ATGAGC      50.00       FALSE</span>
<span class="co">#&gt; 27 RPI27   ATTCCT      33.33       FALSE</span>
<span class="co">#&gt; 28 RPI28   CAAAAG      33.33        TRUE</span>
<span class="co">#&gt; 29 RPI29   CAACTA      33.33       FALSE</span>
<span class="co">#&gt; 30 RPI30   CACCGG      83.33       FALSE</span>
<span class="co">#&gt; 31 RPI31   CACGAT      50.00       FALSE</span>
<span class="co">#&gt; 32 RPI32   CACTCA      50.00       FALSE</span>
<span class="co">#&gt; 33 RPI33   CAGGCG      83.33       FALSE</span>
<span class="co">#&gt; 34 RPI34   CATGGC      66.67       FALSE</span>
<span class="co">#&gt; 35 RPI35   CATTTT      16.67        TRUE</span>
<span class="co">#&gt; 36 RPI36   CCAACA      50.00       FALSE</span>
<span class="co">#&gt; 37 RPI37   CGGAAT      50.00       FALSE</span>
<span class="co">#&gt; 38 RPI38   CTAGCT      50.00       FALSE</span>
<span class="co">#&gt; 39 RPI39   CTATAC      33.33       FALSE</span>
<span class="co">#&gt; 40 RPI40   CTCAGA      50.00       FALSE</span>
<span class="co">#&gt; 41 RPI41   GACGAC      66.67       FALSE</span>
<span class="co">#&gt; 42 RPI42   TAATCG      33.33       FALSE</span>
<span class="co">#&gt; 43 RPI43   TACAGC      50.00       FALSE</span>
<span class="co">#&gt; 44 RPI44   TATAAT       0.00       FALSE</span>
<span class="co">#&gt; 45 RPI45   TCATTC      33.33       FALSE</span>
<span class="co">#&gt; 46 RPI46   TCCCGA      66.67        TRUE</span>
<span class="co">#&gt; 47 RPI47   TCGAAG      50.00       FALSE</span>
<span class="co">#&gt; 48 RPI48   TCGGCA      66.67       FALSE</span></code></pre></div>
</div>
<div id="examples-of-an-exhaustive-search-of-compatible-barcode-combinations" class="section level3">
<h3>Examples of an exhaustive search of compatible barcode combinations</h3>
<p>The total number of combinations depends on the number of available 
barcodes and of the multiplex level. For 48 barcodes and a multiplex 
level of 3, the total number of combination can be calculated using <code>choose(48,3)</code>,
 namely 17296 combinations. However, in many cases the total number of 
combinations can become gigantic and you must not perform an exhaustive 
search (see <code>get_random_combinations()</code> below).</p>
<ul>
<li>48 barcodes, multiplex level of 2, HiSeq plateform</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Total number of combinations</span>
<span class="kw">choose</span>(<span class="dv">48</span>,<span class="dv">2</span>)
<span class="co">#&gt; [1] 1128</span>

<span class="co"># Load barcodes</span>
barcodes &lt;-<span class="st"> </span>DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexes

<span class="co"># Time for an exhaustive search</span>
<span class="kw">system.time</span>(m &lt;-<span class="st"> </span><span class="kw">get_all_combinations</span>(<span class="dt">index_df =</span> barcodes, <span class="dt">mplex_level =</span> <span class="dv">2</span>, <span class="dt">chemistry =</span> <span class="dv">4</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.296   0.003   0.299</span>

<span class="co"># Each line represents a compatible combination of barcodes</span>
<span class="kw">head</span>(m)
<span class="co">#&gt;      [,1]    [,2]   </span>
<span class="co">#&gt; [1,] "RPI04" "RPI35"</span>
<span class="co">#&gt; [2,] "RPI05" "RPI19"</span>
<span class="co">#&gt; [3,] "RPI06" "RPI12"</span>
<span class="co">#&gt; [4,] "RPI07" "RPI17"</span>
<span class="co">#&gt; [5,] "RPI10" "RPI39"</span>
<span class="co">#&gt; [6,] "RPI18" "RPI25"</span></code></pre></div>
<ul>
<li>48 barcodes, multiplex level of 3, HiSeq plateform</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Total number of combinations</span>
<span class="kw">choose</span>(<span class="dv">48</span>,<span class="dv">3</span>)
<span class="co">#&gt; [1] 17296</span>

<span class="co"># Load barcodes</span>
barcodes &lt;-<span class="st"> </span>DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexes

<span class="co"># Time for an exhaustive search</span>
<span class="kw">system.time</span>(m &lt;-<span class="st"> </span><span class="kw">get_all_combinations</span>(<span class="dt">index_df =</span> barcodes, <span class="dt">mplex_level =</span> <span class="dv">3</span>, <span class="dt">chemistry =</span> <span class="dv">4</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   6.288   0.040   6.349</span>

<span class="co"># Each line represents a compatible combination of barcodes</span>
<span class="kw">head</span>(m)
<span class="co">#&gt;      [,1]    [,2]    [,3]   </span>
<span class="co">#&gt; [1,] "RPI01" "RPI02" "RPI48"</span>
<span class="co">#&gt; [2,] "RPI01" "RPI03" "RPI07"</span>
<span class="co">#&gt; [3,] "RPI01" "RPI03" "RPI08"</span>
<span class="co">#&gt; [4,] "RPI01" "RPI03" "RPI09"</span>
<span class="co">#&gt; [5,] "RPI01" "RPI03" "RPI10"</span>
<span class="co">#&gt; [6,] "RPI01" "RPI03" "RPI16"</span></code></pre></div>
</div>
<div id="examples-of-a-random-search-of-compatible-barcode-combinations" class="section level3">
<h3>Examples of a random search of compatible barcode combinations</h3>
<p>When the total number of combinations becomes high, it is recommended
 to pick combinations at random and then select those that are 
compatible.</p>
<ul>
<li>48 barcodes, multiplex level of 3, HiSeq plateform</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Total number of combinations</span>
<span class="kw">choose</span>(<span class="dv">48</span>,<span class="dv">3</span>)
<span class="co">#&gt; [1] 17296</span>

<span class="co"># Load barcodes</span>
barcodes &lt;-<span class="st"> </span>DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexes

<span class="co"># Time for a random search</span>
<span class="kw">system.time</span>(m &lt;-<span class="st"> </span><span class="kw">get_random_combinations</span>(<span class="dt">index_df =</span> barcodes, <span class="dt">mplex_level =</span> <span class="dv">2</span>, <span class="dt">chemistry =</span> <span class="dv">4</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.197   0.005   0.207</span>

<span class="co"># Each line represents a compatible combination of barcodes</span>
<span class="kw">head</span>(m)
<span class="co">#&gt;      [,1]    [,2]   </span>
<span class="co">#&gt; [1,] "RPI06" "RPI12"</span>
<span class="co">#&gt; [2,] "RPI10" "RPI39"</span>
<span class="co">#&gt; [3,] "RPI18" "RPI33"</span>
<span class="co">#&gt; [4,] "RPI20" "RPI30"</span>
<span class="co">#&gt; [5,] "RPI21" "RPI29"</span>
<span class="co">#&gt; [6,] "RPI26" "RPI42"</span></code></pre></div>
<ul>
<li>48 barcodes, multiplex level of 4, HiSeq plateform</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Total number of combinations</span>
<span class="kw">choose</span>(<span class="dv">48</span>,<span class="dv">4</span>)
<span class="co">#&gt; [1] 194580</span>

<span class="co"># Load barcodes</span>
barcodes &lt;-<span class="st"> </span>DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexes

<span class="co"># Time for a random search</span>
<span class="kw">system.time</span>(m &lt;-<span class="st"> </span><span class="kw">get_random_combinations</span>(<span class="dt">index_df =</span> barcodes, <span class="dt">mplex_level =</span> <span class="dv">4</span>, <span class="dt">chemistry =</span> <span class="dv">4</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.685   0.021   0.745</span>

<span class="co"># Each line represents a compatible combination of barcodes</span>
<span class="kw">head</span>(m)
<span class="co">#&gt;      [,1]    [,2]    [,3]    [,4]   </span>
<span class="co">#&gt; [1,] "RPI01" "RPI27" "RPI43" "RPI45"</span>
<span class="co">#&gt; [2,] "RPI01" "RPI10" "RPI13" "RPI16"</span>
<span class="co">#&gt; [3,] "RPI01" "RPI06" "RPI16" "RPI26"</span>
<span class="co">#&gt; [4,] "RPI01" "RPI10" "RPI14" "RPI24"</span>
<span class="co">#&gt; [5,] "RPI01" "RPI02" "RPI08" "RPI17"</span>
<span class="co">#&gt; [6,] "RPI01" "RPI04" "RPI07" "RPI39"</span></code></pre></div>
<ul>
<li>48 barcodes, multiplex level of 6, HiSeq plateform</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Total number of combinations</span>
<span class="kw">choose</span>(<span class="dv">48</span>,<span class="dv">6</span>)
<span class="co">#&gt; [1] 12271512</span>

<span class="co"># Load barcodes</span>
barcodes &lt;-<span class="st"> </span>DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexes

<span class="co"># Time for a random search</span>
<span class="kw">system.time</span>(m &lt;-<span class="st"> </span><span class="kw">get_random_combinations</span>(<span class="dt">index_df =</span> barcodes, <span class="dt">mplex_level =</span> <span class="dv">6</span>, <span class="dt">chemistry =</span> <span class="dv">4</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.957   0.024   1.020</span>

<span class="co"># Each line represents a compatible combination of barcodes</span>
<span class="kw">head</span>(m)
<span class="co">#&gt;      [,1]    [,2]    [,3]    [,4]    [,5]    [,6]   </span>
<span class="co">#&gt; [1,] "RPI01" "RPI16" "RPI27" "RPI30" "RPI36" "RPI48"</span>
<span class="co">#&gt; [2,] "RPI01" "RPI06" "RPI32" "RPI35" "RPI40" "RPI46"</span>
<span class="co">#&gt; [3,] "RPI01" "RPI11" "RPI14" "RPI21" "RPI30" "RPI38"</span>
<span class="co">#&gt; [4,] "RPI01" "RPI04" "RPI07" "RPI20" "RPI22" "RPI45"</span>
<span class="co">#&gt; [5,] "RPI01" "RPI12" "RPI21" "RPI28" "RPI36" "RPI42"</span>
<span class="co">#&gt; [6,] "RPI01" "RPI18" "RPI21" "RPI28" "RPI36" "RPI43"</span></code></pre></div>
</div>
<div id="constrain-barcodes-to-be-robust-against-one-substitution-error" class="section level3">
<h3>Constrain barcodes to be robust against one substitution error</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load barcodes</span>
barcodes &lt;-<span class="st"> </span>DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexes

<span class="co"># Perform a random search of compatible combinations</span>
m &lt;-<span class="st"> </span><span class="kw">get_random_combinations</span>(<span class="dt">index_df =</span> barcodes, <span class="dt">mplex_level =</span> <span class="dv">3</span>, <span class="dt">chemistry =</span> <span class="dv">4</span>)

<span class="co"># Keep barcodes that are robust against one substitution error</span>
filtered_m &lt;-<span class="st"> </span><span class="kw">distance_filter</span>(<span class="dt">index_df =</span> barcodes, <span class="dt">combinations_m =</span> m, <span class="dt">metric =</span> <span class="st">"hamming"</span>, <span class="dt">d =</span> <span class="dv">3</span>)

<span class="co"># Each line represents a compatible combination of barcodes</span>
<span class="kw">head</span>(filtered_m)
<span class="co">#&gt;      V1      V2      V3     </span>
<span class="co">#&gt; [1,] "RPI01" "RPI34" "RPI47"</span>
<span class="co">#&gt; [2,] "RPI01" "RPI14" "RPI43"</span>
<span class="co">#&gt; [3,] "RPI01" "RPI23" "RPI46"</span>
<span class="co">#&gt; [4,] "RPI02" "RPI06" "RPI13"</span>
<span class="co">#&gt; [5,] "RPI02" "RPI41" "RPI47"</span>
<span class="co">#&gt; [6,] "RPI02" "RPI33" "RPI46"</span></code></pre></div>
</div>
<div id="optimize-the-set-of-compatible-combinations-to-reduce-barcode-redundancy-between-lanes" class="section level3">
<h3>Optimize the set of compatible combinations to reduce barcode redundancy between lanes</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Keep set of compatible barcodes that are robust against one substitution error</span>
filtered_m &lt;-<span class="st"> </span><span class="kw">distance_filter</span>(<span class="dt">index_df =</span> DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexes,
                              <span class="dt">combinations_m =</span> <span class="kw">get_random_combinations</span>(<span class="dt">index_df =</span> barcodes, <span class="dt">mplex_level =</span> <span class="dv">3</span>, <span class="dt">chemistry =</span> <span class="dv">4</span>),
                              <span class="dt">metric =</span> <span class="st">"hamming"</span>, <span class="dt">d =</span> <span class="dv">3</span>)

<span class="co"># Use a Shannon-entropy maximization approach to reduce barcode redundancy</span>
df &lt;-<span class="st"> </span><span class="kw">optimize_combinations</span>(<span class="dt">combination_m =</span> filtered_m, <span class="dt">nb_lane =</span> <span class="dv">12</span>, <span class="dt">index_number =</span> <span class="dv">48</span>)
<span class="co">#&gt; [1] "Theoretical max entropy: 3.584"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 3.584"</span>

<span class="co"># Each line represents a compatible combination of barcodes and each row a lane of the flow cell</span>
df
<span class="co">#&gt;       V1      V2      V3     </span>
<span class="co">#&gt;  [1,] "RPI22" "RPI41" "RPI43"</span>
<span class="co">#&gt;  [2,] "RPI04" "RPI05" "RPI44"</span>
<span class="co">#&gt;  [3,] "RPI21" "RPI29" "RPI32"</span>
<span class="co">#&gt;  [4,] "RPI11" "RPI13" "RPI23"</span>
<span class="co">#&gt;  [5,] "RPI02" "RPI19" "RPI31"</span>
<span class="co">#&gt;  [6,] "RPI01" "RPI15" "RPI46"</span>
<span class="co">#&gt;  [7,] "RPI12" "RPI36" "RPI47"</span>
<span class="co">#&gt;  [8,] "RPI07" "RPI16" "RPI17"</span>
<span class="co">#&gt;  [9,] "RPI25" "RPI40" "RPI48"</span>
<span class="co">#&gt; [10,] "RPI18" "RPI28" "RPI34"</span>
<span class="co">#&gt; [11,] "RPI06" "RPI08" "RPI20"</span>
<span class="co">#&gt; [12,] "RPI10" "RPI14" "RPI38"</span></code></pre></div>
</div>
<div id="the-optimized-result-cannot-be-an-optimum-when-filtering-out-too-many-barcodes" class="section level3">
<h3>The optimized result cannot be an optimum when filtering out too many barcodes</h3>
<ul>
<li>Increased distance between barcode sequences: redundancy may become inevitable</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Keep set of compatible barcodes that are robust against multiple substitution and insertion/deletion errors</span>
filtered_m &lt;-<span class="st"> </span><span class="kw">distance_filter</span>(<span class="dt">index_df =</span> DNABarcodeCompatibility<span class="op">::</span>IlluminaIndexes,
                              <span class="dt">combinations_m =</span> <span class="kw">get_random_combinations</span>(<span class="dt">index_df =</span> barcodes, <span class="dt">mplex_level =</span> <span class="dv">3</span>, <span class="dt">chemistry =</span> <span class="dv">4</span>),
                              <span class="dt">metric =</span> <span class="st">"seqlev"</span>, <span class="dt">d =</span> <span class="dv">4</span>)

<span class="co"># Use a Shannon-entropy maximization approach to reduce barcode redundancy</span>
df &lt;-<span class="st"> </span><span class="kw">optimize_combinations</span>(<span class="dt">combination_m =</span> filtered_m, <span class="dt">nb_lane =</span> <span class="dv">12</span>, <span class="dt">index_number =</span> <span class="dv">48</span>)
<span class="co">#&gt; [1] "Theoretical max entropy: 3.584"</span>
<span class="co">#&gt; [1] "Entropy of the optimized set: 2.27"</span>

<span class="co"># Each line represents a compatible combination of barcodes and each row a lane of the flow cell</span>
df
<span class="co">#&gt;       V1      V2      V3     </span>
<span class="co">#&gt;  [1,] "RPI14" "RPI30" "RPI47"</span>
<span class="co">#&gt;  [2,] "RPI03" "RPI23" "RPI27"</span>
<span class="co">#&gt;  [3,] "RPI03" "RPI23" "RPI27"</span>
<span class="co">#&gt;  [4,] "RPI18" "RPI28" "RPI35"</span>
<span class="co">#&gt;  [5,] "RPI14" "RPI30" "RPI47"</span>
<span class="co">#&gt;  [6,] "RPI03" "RPI27" "RPI36"</span>
<span class="co">#&gt;  [7,] "RPI14" "RPI30" "RPI47"</span>
<span class="co">#&gt;  [8,] "RPI18" "RPI28" "RPI35"</span>
<span class="co">#&gt;  [9,] "RPI18" "RPI28" "RPI35"</span>
<span class="co">#&gt; [10,] "RPI14" "RPI30" "RPI47"</span>
<span class="co">#&gt; [11,] "RPI03" "RPI23" "RPI27"</span>
<span class="co">#&gt; [12,] "RPI03" "RPI27" "RPI36"</span></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>



</body></html>